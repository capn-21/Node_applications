{"version":3,"sources":["webpack://sift/webpack/universalModuleDefinition","webpack://sift/webpack/bootstrap","webpack://sift/./src/operations.ts","webpack://sift/./src/core.ts","webpack://sift/./src/utils.ts","webpack://sift/./src/index.ts"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","extendStatics","__extends","b","setPrototypeOf","__proto__","Array","__","constructor","core_1","utils_1","$Ne","_super","apply","arguments","init","_test","createTester","params","options","compare","reset","success","next","item","done","BaseOperation","$ElemMatch","_queryOperation","createQueryOperation","owneryQuery","owner","isArray","length","$Not","$Or","_this","_ops","map","op","length_1","length_2","$Nor","$Exists","$And","query","childrenNext","GroupOperation","$eq","EqualsOperation","$ne","$or","$nor","$elemMatch","$nin","$in","$lt","numericalOperation","$lte","$gt","$gte","$mod","_a","mod","equalsValue","comparable","$exists","$regex","pattern","RegExp","$options","$not","$type","clazz","$and","ownerQuery","$all","$size","$where","test","isFunction","Error","walkKeyPathValues","keyPath","depth","currentKey","isNaN","Number","_children","length_3","childOperation","QueryOperation","parent","NestedOperation","children","_nextNestedValue","a","Function","comparableA","createEqualsOperation","NopeOperation","numericalOperationCreator","createNumericalOperation","typeofParams","createOperation","parentQuery","operationCreator","operations","createNestedOperation","nestedQuery","charAt","containsOperation","createQueryOperations","selfOperations","nestedOperations","ops","push","isVanillaObject","split","createQueryTester","_b","operation","equals","assign","typeChecker","type","typeString","getClassName","toString","Date","getTime","toJSON","isObject","keys","defaultOperations","__export","default"],"mappings":"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","file":"sift.csp.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"sift\"] = factory();\n\telse\n\t\troot[\"sift\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar core_1 = require(\"./core\");\nvar utils_1 = require(\"./utils\");\nvar $Ne = /** @class */ (function (_super) {\n    __extends($Ne, _super);\n    function $Ne() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    $Ne.prototype.init = function () {\n        this._test = core_1.createTester(this.params, this.options.compare);\n    };\n    $Ne.prototype.reset = function () {\n        _super.prototype.reset.call(this);\n        this.success = true;\n    };\n    $Ne.prototype.next = function (item) {\n        if (this._test(item)) {\n            this.done = true;\n            this.success = false;\n        }\n    };\n    return $Ne;\n}(core_1.BaseOperation));\n// https://docs.mongodb.com/manual/reference/operator/query/elemMatch/\nvar $ElemMatch = /** @class */ (function (_super) {\n    __extends($ElemMatch, _super);\n    function $ElemMatch() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    $ElemMatch.prototype.init = function () {\n        this._queryOperation = core_1.createQueryOperation(this.params, this.owneryQuery, this.options);\n    };\n    $ElemMatch.prototype.reset = function () {\n        this._queryOperation.reset();\n    };\n    $ElemMatch.prototype.next = function (item, key, owner) {\n        this._queryOperation.reset();\n        if (utils_1.isArray(owner)) {\n            this._queryOperation.next(item, key, owner);\n            this.done = this._queryOperation.done || key === owner.length - 1;\n            this.success = this._queryOperation.success;\n        }\n        else {\n            this.done = true;\n            this.success = false;\n        }\n    };\n    return $ElemMatch;\n}(core_1.BaseOperation));\nvar $Not = /** @class */ (function (_super) {\n    __extends($Not, _super);\n    function $Not() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    $Not.prototype.init = function () {\n        this._queryOperation = core_1.createQueryOperation(this.params, this.owneryQuery, this.options);\n    };\n    $Not.prototype.reset = function () {\n        this._queryOperation.reset();\n    };\n    $Not.prototype.next = function (item, key, owner) {\n        this._queryOperation.next(item, key, owner);\n        this.done = this._queryOperation.done;\n        this.success = !this._queryOperation.success;\n    };\n    return $Not;\n}(core_1.BaseOperation));\nvar $Or = /** @class */ (function (_super) {\n    __extends($Or, _super);\n    function $Or() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    $Or.prototype.init = function () {\n        var _this = this;\n        this._ops = this.params.map(function (op) {\n            return core_1.createQueryOperation(op, null, _this.options);\n        });\n    };\n    $Or.prototype.reset = function () {\n        this.done = false;\n        this.success = false;\n        for (var i = 0, length_1 = this._ops.length; i < length_1; i++) {\n            this._ops[i].reset();\n        }\n    };\n    $Or.prototype.next = function (item, key, owner) {\n        var done = false;\n        var success = false;\n        for (var i = 0, length_2 = this._ops.length; i < length_2; i++) {\n            var op = this._ops[i];\n            op.next(item, key, owner);\n            if (op.success) {\n                done = true;\n                success = op.success;\n                break;\n            }\n        }\n        this.success = success;\n        this.done = done;\n    };\n    return $Or;\n}(core_1.BaseOperation));\nvar $Nor = /** @class */ (function (_super) {\n    __extends($Nor, _super);\n    function $Nor() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    $Nor.prototype.next = function (item, key, owner) {\n        _super.prototype.next.call(this, item, key, owner);\n        this.success = !this.success;\n    };\n    return $Nor;\n}($Or));\nvar $Exists = /** @class */ (function (_super) {\n    __extends($Exists, _super);\n    function $Exists() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    $Exists.prototype.next = function (item, key, owner) {\n        if (owner.hasOwnProperty(key) === this.params) {\n            this.done = true;\n            this.success = true;\n        }\n    };\n    return $Exists;\n}(core_1.BaseOperation));\nvar $And = /** @class */ (function (_super) {\n    __extends($And, _super);\n    function $And(params, owneryQuery, options) {\n        return _super.call(this, params, owneryQuery, options, params.map(function (query) { return core_1.createQueryOperation(query, owneryQuery, options); })) || this;\n    }\n    $And.prototype.next = function (item, key, owner) {\n        this.childrenNext(item, key, owner);\n    };\n    return $And;\n}(core_1.GroupOperation));\nexports.$eq = function (params, owneryQuery, options) {\n    return new core_1.EqualsOperation(params, owneryQuery, options);\n};\nexports.$ne = function (params, owneryQuery, options) {\n    return new $Ne(params, owneryQuery, options);\n};\nexports.$or = function (params, owneryQuery, options) {\n    return new $Or(params, owneryQuery, options);\n};\nexports.$nor = function (params, owneryQuery, options) {\n    return new $Nor(params, owneryQuery, options);\n};\nexports.$elemMatch = function (params, owneryQuery, options) {\n    return new $ElemMatch(params, owneryQuery, options);\n};\nexports.$nin = function (params, owneryQuery, options) {\n    return new $Nor(params, owneryQuery, options);\n};\nexports.$in = function (params, owneryQuery, options) {\n    return new $Or(params, owneryQuery, options);\n};\nexports.$lt = core_1.numericalOperation(function (params) { return function (b) { return b < params; }; });\nexports.$lte = core_1.numericalOperation(function (params) { return function (b) { return b <= params; }; });\nexports.$gt = core_1.numericalOperation(function (params) { return function (b) { return b > params; }; });\nexports.$gte = core_1.numericalOperation(function (params) { return function (b) { return b >= params; }; });\nexports.$mod = function (_a, owneryQuery, options) {\n    var mod = _a[0], equalsValue = _a[1];\n    return new core_1.EqualsOperation(function (b) { return utils_1.comparable(b) % mod === equalsValue; }, owneryQuery, options);\n};\nexports.$exists = function (params, owneryQuery, options) { return new $Exists(params, owneryQuery, options); };\nexports.$regex = function (pattern, owneryQuery, options) {\n    return new core_1.EqualsOperation(new RegExp(pattern, owneryQuery.$options), owneryQuery, options);\n};\nexports.$not = function (params, owneryQuery, options) {\n    return new $Not(params, owneryQuery, options);\n};\nexports.$type = function (clazz, owneryQuery, options) {\n    return new core_1.EqualsOperation(function (b) { return (b != null ? b instanceof clazz || b.constructor === clazz : false); }, owneryQuery, options);\n};\nexports.$and = function (params, ownerQuery, options) {\n    return new $And(params, ownerQuery, options);\n};\nexports.$all = exports.$and;\nexports.$size = function (params, ownerQuery, options) {\n    return new core_1.EqualsOperation(function (b) { return b && b.length === params; }, ownerQuery, options);\n};\nexports.$options = function () { return null; };\nexports.$where = function (params, ownerQuery, options) {\n    var test;\n    if (utils_1.isFunction(params)) {\n        test = params;\n    }\n    else if (!process.env.CSP_ENABLED) {\n        test = new Function(\"obj\", \"return \" + params);\n    }\n    else {\n        throw new Error(\"In CSP mode, sift does not support strings in \\\"$where\\\" condition\");\n    }\n    return new core_1.EqualsOperation(function (b) { return test.bind(b)(b); }, ownerQuery, options);\n};\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = require(\"./utils\");\n/**\n * Walks through each value given the context - used for nested operations. E.g:\n * { \"person.address\": { $eq: \"blarg\" }}\n */\nvar walkKeyPathValues = function (item, keyPath, next, depth, key, owner) {\n    var currentKey = keyPath[depth];\n    // if array, then try matching. Might fall through for cases like:\n    // { $eq: [1, 2, 3] }, [ 1, 2, 3 ].\n    if (utils_1.isArray(item) && isNaN(Number(currentKey))) {\n        for (var i = 0, length_1 = item.length; i < length_1; i++) {\n            // if FALSE is returned, then terminate walker. For operations, this simply\n            // means that the search critera was met.\n            if (!walkKeyPathValues(item[i], keyPath, next, depth, i, item)) {\n                return false;\n            }\n        }\n    }\n    if (depth === keyPath.length || item == null) {\n        return next(item, key, owner);\n    }\n    return walkKeyPathValues(item[currentKey], keyPath, next, depth + 1, currentKey, item);\n};\nvar BaseOperation = /** @class */ (function () {\n    function BaseOperation(params, owneryQuery, options) {\n        this.params = params;\n        this.owneryQuery = owneryQuery;\n        this.options = options;\n        this.init();\n    }\n    BaseOperation.prototype.init = function () { };\n    BaseOperation.prototype.reset = function () {\n        this.done = false;\n        this.success = false;\n    };\n    return BaseOperation;\n}());\nexports.BaseOperation = BaseOperation;\nvar GroupOperation = /** @class */ (function (_super) {\n    __extends(GroupOperation, _super);\n    function GroupOperation(params, owneryQuery, options, _children) {\n        var _this = _super.call(this, params, owneryQuery, options) || this;\n        _this._children = _children;\n        return _this;\n    }\n    /**\n     */\n    GroupOperation.prototype.reset = function () {\n        this.success = false;\n        this.done = false;\n        for (var i = 0, length_2 = this._children.length; i < length_2; i++) {\n            this._children[i].reset();\n        }\n    };\n    /**\n     */\n    GroupOperation.prototype.childrenNext = function (item, key, owner) {\n        var done = true;\n        var success = true;\n        for (var i = 0, length_3 = this._children.length; i < length_3; i++) {\n            var childOperation = this._children[i];\n            childOperation.next(item, key, owner);\n            if (!childOperation.success) {\n                success = false;\n            }\n            if (childOperation.done) {\n                if (!childOperation.success) {\n                    break;\n                }\n            }\n            else {\n                done = false;\n            }\n        }\n        // console.log(\"DONE\", this.params, done, success);\n        this.done = done;\n        this.success = success;\n    };\n    return GroupOperation;\n}(BaseOperation));\nexports.GroupOperation = GroupOperation;\nvar QueryOperation = /** @class */ (function (_super) {\n    __extends(QueryOperation, _super);\n    function QueryOperation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     */\n    QueryOperation.prototype.next = function (item, key, parent) {\n        this.childrenNext(item, key, parent);\n    };\n    return QueryOperation;\n}(GroupOperation));\nexports.QueryOperation = QueryOperation;\nvar NestedOperation = /** @class */ (function (_super) {\n    __extends(NestedOperation, _super);\n    function NestedOperation(keyPath, params, owneryQuery, options, children) {\n        var _this = _super.call(this, params, owneryQuery, options, children) || this;\n        _this.keyPath = keyPath;\n        /**\n         */\n        _this._nextNestedValue = function (value, key, owner) {\n            _this.childrenNext(value, key, owner);\n            return !_this.done;\n        };\n        return _this;\n    }\n    /**\n     */\n    NestedOperation.prototype.next = function (item, key, parent) {\n        walkKeyPathValues(item, this.keyPath, this._nextNestedValue, 0, key, parent);\n    };\n    return NestedOperation;\n}(GroupOperation));\nexports.NestedOperation = NestedOperation;\nexports.createTester = function (a, compare) {\n    if (a instanceof Function) {\n        return a;\n    }\n    if (a instanceof RegExp) {\n        return function (b) { return typeof b === \"string\" && a.test(b); };\n    }\n    var comparableA = utils_1.comparable(a);\n    return function (b) { return compare(comparableA, utils_1.comparable(b)); };\n};\nvar EqualsOperation = /** @class */ (function (_super) {\n    __extends(EqualsOperation, _super);\n    function EqualsOperation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    EqualsOperation.prototype.init = function () {\n        this._test = exports.createTester(this.params, this.options.compare);\n    };\n    EqualsOperation.prototype.next = function (item, key, parent) {\n        if (this._test(item, key, parent)) {\n            this.done = true;\n            this.success = true;\n        }\n    };\n    return EqualsOperation;\n}(BaseOperation));\nexports.EqualsOperation = EqualsOperation;\nexports.createEqualsOperation = function (params, owneryQuery, options) { return new EqualsOperation(params, owneryQuery, options); };\nvar NopeOperation = /** @class */ (function (_super) {\n    __extends(NopeOperation, _super);\n    function NopeOperation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    NopeOperation.prototype.next = function () {\n        this.done = true;\n        this.success = false;\n    };\n    return NopeOperation;\n}(BaseOperation));\nexports.NopeOperation = NopeOperation;\nexports.numericalOperationCreator = function (createNumericalOperation) { return function (params, owneryQuery, options) {\n    if (params == null) {\n        return new NopeOperation(params, owneryQuery, options);\n    }\n    return createNumericalOperation(params, owneryQuery, options);\n}; };\nexports.numericalOperation = function (createTester) {\n    return exports.numericalOperationCreator(function (params, owneryQuery, options) {\n        var typeofParams = typeof utils_1.comparable(params);\n        var test = createTester(params);\n        return new EqualsOperation(function (b) {\n            return typeof utils_1.comparable(b) === typeofParams && test(b);\n        }, owneryQuery, options);\n    });\n};\nvar createOperation = function (name, params, parentQuery, options) {\n    var operationCreator = options.operations[name];\n    if (!operationCreator) {\n        throw new Error(\"Unsupported operation: \" + name);\n    }\n    return operationCreator(params, parentQuery, options);\n};\nvar containsOperation = function (query) {\n    for (var key in query) {\n        if (key.charAt(0) === \"$\")\n            return true;\n    }\n    return false;\n};\nvar createNestedOperation = function (keyPath, nestedQuery, owneryQuery, options) {\n    if (containsOperation(nestedQuery)) {\n        var _a = createQueryOperations(nestedQuery, options), selfOperations = _a[0], nestedOperations = _a[1];\n        if (nestedOperations.length) {\n            throw new Error(\"Property queries must contain only operations, or exact objects.\");\n        }\n        return new NestedOperation(keyPath, nestedQuery, owneryQuery, options, selfOperations);\n    }\n    return new NestedOperation(keyPath, nestedQuery, owneryQuery, options, [\n        new EqualsOperation(nestedQuery, owneryQuery, options)\n    ]);\n};\nexports.createQueryOperation = function (query, owneryQuery, options) {\n    var _a = createQueryOperations(query, options), selfOperations = _a[0], nestedOperations = _a[1];\n    var ops = [];\n    if (selfOperations.length) {\n        ops.push(new NestedOperation([], query, owneryQuery, options, selfOperations));\n    }\n    ops.push.apply(ops, nestedOperations);\n    if (ops.length === 1) {\n        return ops[0];\n    }\n    return new QueryOperation(query, owneryQuery, options, ops);\n};\nvar createQueryOperations = function (query, options) {\n    var selfOperations = [];\n    var nestedOperations = [];\n    if (!utils_1.isVanillaObject(query)) {\n        selfOperations.push(new EqualsOperation(query, query, options));\n        return [selfOperations, nestedOperations];\n    }\n    for (var key in query) {\n        if (key.charAt(0) === \"$\") {\n            var op = createOperation(key, query[key], query, options);\n            // probably just a flag for another operation (like $options)\n            if (op != null) {\n                selfOperations.push(op);\n            }\n        }\n        else {\n            nestedOperations.push(createNestedOperation(key.split(\".\"), query[key], query, options));\n        }\n    }\n    return [selfOperations, nestedOperations];\n};\nexports.createQueryTester = function (query, _a) {\n    var _b = _a === void 0 ? {} : _a, compare = _b.compare, operations = _b.operations;\n    var operation = exports.createQueryOperation(query, null, {\n        compare: compare || utils_1.equals,\n        operations: Object.assign({}, operations || {})\n    });\n    return function (item, key, owner) {\n        operation.reset();\n        operation.next(item, key, owner);\n        return operation.success;\n    };\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.typeChecker = function (type) {\n    var typeString = \"[object \" + type + \"]\";\n    return function (value) {\n        return getClassName(value) === typeString;\n    };\n};\nvar getClassName = function (value) { return Object.prototype.toString.call(value); };\nexports.comparable = function (value) {\n    if (value instanceof Date) {\n        return value.getTime();\n    }\n    else if (exports.isArray(value)) {\n        return value.map(exports.comparable);\n    }\n    else if (value && typeof value.toJSON === \"function\") {\n        return value.toJSON();\n    }\n    return value;\n};\nexports.isArray = exports.typeChecker(\"Array\");\nexports.isObject = exports.typeChecker(\"Object\");\nexports.isFunction = exports.typeChecker(\"Function\");\nexports.isVanillaObject = function (value) {\n    return (value &&\n        (value.constructor === Object ||\n            value.constructor === Array ||\n            value.constructor.toString() === \"function Object() { [native code] }\" ||\n            value.constructor.toString() === \"function Array() { [native code] }\") &&\n        !value.toJSON);\n};\nexports.equals = function (a, b) {\n    if (a == null && a == b) {\n        return true;\n    }\n    if (a === b) {\n        return true;\n    }\n    if (Object.prototype.toString.call(a) !== Object.prototype.toString.call(b)) {\n        return false;\n    }\n    if (exports.isArray(a)) {\n        if (a.length !== b.length) {\n            return false;\n        }\n        for (var i = 0, length_1 = a.length; i < length_1; i++) {\n            if (!exports.equals(a[i], b[i]))\n                return false;\n        }\n        return true;\n    }\n    else if (exports.isObject(a)) {\n        if (Object.keys(a).length !== Object.keys(b).length) {\n            return false;\n        }\n        for (var key in a) {\n            if (!exports.equals(a[key], b[key]))\n                return false;\n        }\n        return true;\n    }\n    return false;\n};\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar defaultOperations = require(\"./operations\");\nvar core_1 = require(\"./core\");\nexports.createQueryTester = core_1.createQueryTester;\nexports.EqualsOperation = core_1.EqualsOperation;\nexports.createEqualsOperation = core_1.createEqualsOperation;\nvar createDefaultQueryTester = function (query, _a) {\n    var _b = _a === void 0 ? {} : _a, compare = _b.compare, operations = _b.operations;\n    return core_1.createQueryTester(query, {\n        compare: compare,\n        operations: Object.assign({}, defaultOperations, operations)\n    });\n};\n__export(require(\"./operations\"));\nexports.default = createDefaultQueryTester;\n"],"sourceRoot":""}