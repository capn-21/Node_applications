!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.sift=e():t.sift=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),u=n(2),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.init=function(){this._test=i.createTester(this.params,this.options.compare)},e.prototype.reset=function(){t.prototype.reset.call(this),this.success=!0},e.prototype.next=function(t){this._test(t)&&(this.done=!0,this.success=!1)},e}(i.BaseOperation),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.init=function(){this._queryOperation=i.createQueryOperation(this.params,this.owneryQuery,this.options)},e.prototype.reset=function(){this._queryOperation.reset()},e.prototype.next=function(t,e,n){this._queryOperation.reset(),u.isArray(n)?(this._queryOperation.next(t,e,n),this.done=this._queryOperation.done||e===n.length-1,this.success=this._queryOperation.success):(this.done=!0,this.success=!1)},e}(i.BaseOperation),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.init=function(){this._queryOperation=i.createQueryOperation(this.params,this.owneryQuery,this.options)},e.prototype.reset=function(){this._queryOperation.reset()},e.prototype.next=function(t,e,n){this._queryOperation.next(t,e,n),this.done=this._queryOperation.done,this.success=!this._queryOperation.success},e}(i.BaseOperation),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.init=function(){var t=this;this._ops=this.params.map((function(e){return i.createQueryOperation(e,null,t.options)}))},e.prototype.reset=function(){this.done=!1,this.success=!1;for(var t=0,e=this._ops.length;t<e;t++)this._ops[t].reset()},e.prototype.next=function(t,e,n){for(var r=!1,o=!1,i=0,u=this._ops.length;i<u;i++){var s=this._ops[i];if(s.next(t,e,n),s.success){r=!0,o=s.success;break}}this.success=o,this.done=r},e}(i.BaseOperation),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.next=function(e,n,r){t.prototype.next.call(this,e,n,r),this.success=!this.success},e}(p),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.next=function(t,e,n){n.hasOwnProperty(e)===this.params&&(this.done=!0,this.success=!0)},e}(i.BaseOperation),h=function(t){function e(e,n,r){return t.call(this,e,n,r,e.map((function(t){return i.createQueryOperation(t,n,r)})))||this}return o(e,t),e.prototype.next=function(t,e,n){this.childrenNext(t,e,n)},e}(i.GroupOperation);e.$eq=function(t,e,n){return new i.EqualsOperation(t,e,n)},e.$ne=function(t,e,n){return new s(t,e,n)},e.$or=function(t,e,n){return new p(t,e,n)},e.$nor=function(t,e,n){return new f(t,e,n)},e.$elemMatch=function(t,e,n){return new c(t,e,n)},e.$nin=function(t,e,n){return new f(t,e,n)},e.$in=function(t,e,n){return new p(t,e,n)},e.$lt=i.numericalOperation((function(t){return function(e){return e<t}})),e.$lte=i.numericalOperation((function(t){return function(e){return e<=t}})),e.$gt=i.numericalOperation((function(t){return function(e){return e>t}})),e.$gte=i.numericalOperation((function(t){return function(e){return e>=t}})),e.$mod=function(t,e,n){var r=t[0],o=t[1];return new i.EqualsOperation((function(t){return u.comparable(t)%r===o}),e,n)},e.$exists=function(t,e,n){return new l(t,e,n)},e.$regex=function(t,e,n){return new i.EqualsOperation(new RegExp(t,e.$options),e,n)},e.$not=function(t,e,n){return new a(t,e,n)},e.$type=function(t,e,n){return new i.EqualsOperation((function(e){return null!=e&&(e instanceof t||e.constructor===t)}),e,n)},e.$and=function(t,e,n){return new h(t,e,n)},e.$all=e.$and,e.$size=function(t,e,n){return new i.EqualsOperation((function(e){return e&&e.length===t}),e,n)},e.$options=function(){return null},e.$where=function(t,e,n){var r;if(!u.isFunction(t))throw new Error('In CSP mode, sift does not support strings in "$where" condition');return r=t,new i.EqualsOperation((function(t){return r.bind(t)(t)}),e,n)}},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),u=function(t,e,n,r,o,s){var c=e[r];if(i.isArray(t)&&isNaN(Number(c)))for(var a=0,p=t.length;a<p;a++)if(!u(t[a],e,n,r,a,t))return!1;return r===e.length||null==t?n(t,o,s):u(t[c],e,n,r+1,c,t)},s=function(){function t(t,e,n){this.params=t,this.owneryQuery=e,this.options=n,this.init()}return t.prototype.init=function(){},t.prototype.reset=function(){this.done=!1,this.success=!1},t}();e.BaseOperation=s;var c=function(t){function e(e,n,r,o){var i=t.call(this,e,n,r)||this;return i._children=o,i}return o(e,t),e.prototype.reset=function(){this.success=!1,this.done=!1;for(var t=0,e=this._children.length;t<e;t++)this._children[t].reset()},e.prototype.childrenNext=function(t,e,n){for(var r=!0,o=!0,i=0,u=this._children.length;i<u;i++){var s=this._children[i];if(s.next(t,e,n),s.success||(o=!1),s.done){if(!s.success)break}else r=!1}this.done=r,this.success=o},e}(s);e.GroupOperation=c;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.next=function(t,e,n){this.childrenNext(t,e,n)},e}(c);e.QueryOperation=a;var p=function(t){function e(e,n,r,o,i){var u=t.call(this,n,r,o,i)||this;return u.keyPath=e,u._nextNestedValue=function(t,e,n){return u.childrenNext(t,e,n),!u.done},u}return o(e,t),e.prototype.next=function(t,e,n){u(t,this.keyPath,this._nextNestedValue,0,e,n)},e}(c);e.NestedOperation=p,e.createTester=function(t,e){if(t instanceof Function)return t;if(t instanceof RegExp)return function(e){return"string"==typeof e&&t.test(e)};var n=i.comparable(t);return function(t){return e(n,i.comparable(t))}};var f=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.init=function(){this._test=e.createTester(this.params,this.options.compare)},n.prototype.next=function(t,e,n){this._test(t,e,n)&&(this.done=!0,this.success=!0)},n}(s);e.EqualsOperation=f,e.createEqualsOperation=function(t,e,n){return new f(t,e,n)};var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.next=function(){this.done=!0,this.success=!1},e}(s);e.NopeOperation=l,e.numericalOperationCreator=function(t){return function(e,n,r){return null==e?new l(e,n,r):t(e,n,r)}},e.numericalOperation=function(t){return e.numericalOperationCreator((function(e,n,r){var o=typeof i.comparable(e),u=t(e);return new f((function(t){return typeof i.comparable(t)===o&&u(t)}),n,r)}))};var h=function(t,e,n,r){var o=r.operations[t];if(!o)throw new Error("Unsupported operation: "+t);return o(e,n,r)},y=function(t,e,n,r){if(function(t){for(var e in t)if("$"===e.charAt(0))return!0;return!1}(e)){var o=O(e,r),i=o[0];if(o[1].length)throw new Error("Property queries must contain only operations, or exact objects.");return new p(t,e,n,r,i)}return new p(t,e,n,r,[new f(e,n,r)])};e.createQueryOperation=function(t,e,n){var r=O(t,n),o=r[0],i=r[1],u=[];return o.length&&u.push(new p([],t,e,n,o)),u.push.apply(u,i),1===u.length?u[0]:new a(t,e,n,u)};var O=function(t,e){var n=[],r=[];if(!i.isVanillaObject(t))return n.push(new f(t,t,e)),[n,r];for(var o in t)if("$"===o.charAt(0)){var u=h(o,t[o],t,e);null!=u&&n.push(u)}else r.push(y(o.split("."),t[o],t,e));return[n,r]};e.createQueryTester=function(t,n){var r=void 0===n?{}:n,o=r.compare,u=r.operations,s=e.createQueryOperation(t,null,{compare:o||i.equals,operations:Object.assign({},u||{})});return function(t,e,n){return s.reset(),s.next(t,e,n),s.success}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.typeChecker=function(t){var e="[object "+t+"]";return function(t){return r(t)===e}};var r=function(t){return Object.prototype.toString.call(t)};e.comparable=function(t){return t instanceof Date?t.getTime():e.isArray(t)?t.map(e.comparable):t&&"function"==typeof t.toJSON?t.toJSON():t},e.isArray=e.typeChecker("Array"),e.isObject=e.typeChecker("Object"),e.isFunction=e.typeChecker("Function"),e.isVanillaObject=function(t){return t&&(t.constructor===Object||t.constructor===Array||"function Object() { [native code] }"===t.constructor.toString()||"function Array() { [native code] }"===t.constructor.toString())&&!t.toJSON},e.equals=function(t,n){if(null==t&&t==n)return!0;if(t===n)return!0;if(Object.prototype.toString.call(t)!==Object.prototype.toString.call(n))return!1;if(e.isArray(t)){if(t.length!==n.length)return!1;for(var r=0,o=t.length;r<o;r++)if(!e.equals(t[r],n[r]))return!1;return!0}if(e.isObject(t)){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(var i in t)if(!e.equals(t[i],n[i]))return!1;return!0}return!1}},function(t,e,n){t.exports=n(4)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(1);e.createQueryTester=o.createQueryTester,e.EqualsOperation=o.EqualsOperation,e.createEqualsOperation=o.createEqualsOperation;!function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(0)),e.default=function(t,e){var n=void 0===e?{}:e,i=n.compare,u=n.operations;return o.createQueryTester(t,{compare:i,operations:Object.assign({},r,u)})}}])}));
//# sourceMappingURL=sift.csp.min.js.map